{% extends "layout.html" %}
{% block graphs %}

<title>home IoT</title>


<div class="container">
  <nav class="nav justify-content-end" style="margin-bottom: 50px;">
    <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">houme IoT</a>
    <a class="nav-link" href="#">analytics</a>
  </nav>
</div>



<div class="container">

  <div class="row"style="margin-bottom: 50px;">
    <div class="col">
      <div id="temp" style="margin-bottom: 50px;"><h3>temperature outside </h3><h3 id="tmp"></h3></div>

      </div>


        <div class="col">
          <h4>lights cortyard</h4>
          <div class="btn-group" role="group" aria-label="lights1">
            <button type="button" class="btn btn-outline-secondary" id="on">On</button>
            <button type="button" class="btn btn-outline-secondary" aria-pressed="false" id="off">Off</button>
          </div>
          <h5 id="state"></h5>
      </div>

  </div>



    <div class="row">
      <div class="col"  >
            <div id="myplot"><p>temperature</p></div>
    </div>

    <div class="col">
          <div id="myplot2" style="margin-bottom: 50px;"><p>humidity</p></div>
    </div>
  </div>
</div>

<!-- <div class='bokeh'>
    {{div|safe }}
    {{script|safe }}
</div> -->




  <!-- <script>
  fetch('/temp_out')
    .then(function(response) {
      return response.json()
    // Your code for handling the data you get from the API
  })
    .then(function(result) {

      var temp = document.getElementById("tmp").innerText = result;

  })
    // .then(function(json) { console.log(json); })

  </script> -->
  <script>
    function changeClass(){
        document.getElementById("on").className = "btn btn-outline-secondary active";
        document.getElementById("off").className = "btn btn-outline-secondary";
    }
    function changeClass_toggle(){
        document.getElementById("off").className = "btn btn-outline-secondary active";
        document.getElementById("on").className = "btn btn-outline-secondary";

    }
    var lights_on = document.getElementById("on");
    var lights_off = document.getElementById("off");

    lights_on.onclick = changeClass;
    lights_off.onclick = changeClass_toggle;


    // lights_off.onclick = function() {
    //     document.getElementById("state").innerText = "off" ;
    //     console.log(lights_off);
    //   }


  </script>


  <script>
    const context = document.getElementById('tmp').innerText;
    const source = new EventSource("/stream");

    source.onmessage = function (event) {
      const data = JSON.parse(event.data);
      // var data = JSON.parse(event.data);
      document.getElementById("tmp").innerText = data.value;
      console.log(JSON.stringify(data));
    }

  </script>

  <script>
  fetch('/pl')
    .then(function(response) { return response.json(); })
    .then(function(item) { Bokeh.embed.embed_item(item, "myplot"); })
  </script>
  <script>
  fetch('/pl2')
    .then(function(response) { return response.json(); })
    .then(function(item) { Bokeh.embed.embed_item(item, "myplot2"); })
  </script>


{% endblock graphs%}
